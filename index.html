<!DOCTYPE html>
<html>
    <head>
        <title>SATO Label Test</title>
        <meta charset="utf-8">
    </head>
    <body>
        <div class="toolbar">
            <button type="button" onclick="satoLabel.helloWorld();">Hello World</button>
            <button type="button" onclick="satoLabel.initialize();">Clear</button>
            <button type="button" onclick="satoLabel.startLabel();">Start Label</button>
            <button type="button" onclick="satoLabel.addCarriageReturn();">New Line</button>
            Horizontal Position <input class="horizontal-position" /> 
            Vertical Position <input class="vertical-position" /> 
            Font <input class="font" />
            Text <input class="text" />
            <button type="button" class="addText">Add Text</button>
            <button type="button" onclick="satoLabel.endLabel();">End Label</button>
        </div>
        <textarea class="display" style="display:inline-block;height:400px;width:49%;border:1px solid black;"></textarea>
        <div class="console" style="display:inline-block;height:400px;width:49%;white-space:pre-wrap;overflow:scroll;border:1px solid black;"></div>
        <div class="labels"></div>
        <script src="js/JsBarcode.all.min.js"></script>
        <script src="js/sato-label.js"></script>
        <script>
            var satoPrinter = new SatoPrinter();
            var satoLabel = new SatoLabel();
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('addText')) {
                    var x = document.querySelector('.horizontal-position').value.trim();
                    var y = document.querySelector('.vertical-position').value.trim();
                    var font = document.querySelector('.font').value.trim().toUpperCase();
                    var text = document.querySelector('.text').value.trim();
                    satoLabel.addText(x, y, font, text);
                }

                setTimeout(function() {
                    document.querySelector('.display').value = satoLabel.text();
                    document.querySelector('.labels').innerHTML = satoPrinter.html(satoLabel.text());
                    var scripts = document.querySelector('.labels').getElementsByTagName('script');
                    for (var i = 0; i < scripts.length; i++) {
                        var script = scripts[i];
                        eval(script.text);
                    }
                }, 250);
            });

            document.addEventListener('keyup', function(e) {
                if (e.target.classList.contains('display')) {
                    satoLabel.code = e.target.value;
                }

                setTimeout(function() {
                    document.querySelector('.labels').innerHTML = satoPrinter.html(satoLabel.text());
                    var scripts = document.querySelector('.labels').getElementsByTagName('script');
                    for (var i = 0; i < scripts.length; i++) {
                        var script = scripts[i];
                        eval(script.text);
                    }
                }, 250);
            });
        </script>
    </body>
</html>